### 阻塞锁

lock语句可以很好地处理99%的情况，关于锁的使用，有4条原则：

- 限制锁的作用范围（lock语句的作用对象应为私有）
- 文档中写清锁保护的内容
- 锁范围内的代码尽量少
- 在控制锁的时候绝不运行随意的代码（引发事件、调用虚方法、调用委托）

### 异步锁

```c#
private readonly SemaphoreSlim _mutex = new SemaphoreSlim(1);
private int _value;
public async Task DelayAndIncrementAsync()
{
    await _mutex.WaitAsync();
    try
    {
        var oldValue = _value;
        await Task.Delay(TimeSpan.FromSeconds(oldValue));
        _value = oldValue + 1;
    }
    finally
    {
        _mutex.Release();
    }
}
```

### 阻塞信号

锁是来保护共享数据的，不能作为信号。